<ui:composition template="/pages/workspace_page.xhtml"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:c="http://java.sun.com/jstl/core"
  xmlns:nxd="http://nuxeo.org/nxweb/document"
  xmlns:nxl="http://nuxeo.org/nxforms/layout">

  <ui:define name="page title">#{nuxeoApplicationName} - #{nxd:titleOrId(currentDocument)}</ui:define>

  <ui:define name="bookmark">
    <link rel="bookmark" href="#{navigationContext.currentDocumentFullUrl}"/>
  </ui:define>

  <ui:define name="body">
    <div class="mainFragment">
    
        <h:panelGroup rendered="#{not eloraWebActions.isAny2PdfConverterAvailable}">
            <h:outputText styleClass="processMessage completeError" value="#{messages['eloraplm.message.error.any2PdfConverterNotAvailable']}" />
        </h:panelGroup>
    
      <h:form id="document_header_layout_form" class="titleBlock">
        <nxl:documentLayout documentMode="header" mode="view"
          value="#{currentDocument}" defaultLayout="elora_document_header"
          includeAnyMode="false" />
      </h:form>

      <ui:include src="/incl/document_actions_upperbuttons.xhtml"/>
      <ui:include src="/incl/message_banner.xhtml"/>
      
      <c:choose>
        <c:when test="#{currentDocument.type eq 'ReservedCode'}">
        </c:when>
        <c:when test="#{currentDocument.hasFacet('CMProcess')}">
          <nxl:widget name="cm_summary_document_header" mode="any" value="#{currentDocument}" /> 
        </c:when>
        <c:when test="#{currentDocument.type eq 'Project'}">
          <nxl:widget name="project_summary_document_header" mode="any" value="#{currentDocument}" /> 
        </c:when>
        <c:when test="#{currentDocument.hasFacet('EloraWorkspace')}">
          <nxl:widget name="ws_summary_document_header" mode="any" value="#{currentDocument}" /> 
        </c:when>
        <c:otherwise>
          <nxl:widget name="summary_current_document_header" mode="any" value="#{currentDocument}" />
        </c:otherwise>
      </c:choose>
      
      
      <ui:fragment rendered="#{not currentDocument.isImmutable()}">
          <h:panelGroup styleClass="isObsoleteMessage" rendered="#{eloraWebActions.isWcObsolete()}">
            #{messages['eloraplm.message.docIsObsolete']}
          </h:panelGroup>
      </ui:fragment>
      
      <ui:fragment rendered="#{currentDocument.isImmutable()}">
          <h:panelGroup styleClass="isObsoleteMessage" rendered="#{eloraWebActions.isAvObsolete()}">
            #{messages['eloraplm.message.docIsObsolete']}
          </h:panelGroup>
      
          <h:panelGroup styleClass="goToWcMessage">
            #{messages['eloraplm.message.docIsArchivedVersion']}
            <nxd:restDocumentLink document="#{documentManager.getWorkingCopy(currentDocument.ref)}"
                styleClass="button">#{messages['eloraplm.command.goToWorkingCopy']}</nxd:restDocumentLink>
          </h:panelGroup>
      </ui:fragment>
      
      <nxl:widget name="documentTabs" mode="view" value="#{currentDocument}" />

    </div>
  </ui:define>

</ui:composition>
