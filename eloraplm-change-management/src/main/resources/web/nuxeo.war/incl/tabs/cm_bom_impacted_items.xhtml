<ui:composition
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:nxl="http://nuxeo.org/nxforms/layout"
  xmlns:c="http://java.sun.com/jstl/core">


    <c:if test="#{currentDocument.lockInfo.owner != currentUser and currentDocument.currentLifeCycleState == 'asyncProcessing'}">
      <div class="processMessage completeWarning"><h:outputText value="#{messages['eloraplm.message.warning.cm.batch.batchProcessInProgressByAnotherUser']}"/></div>
    </c:if>
    
    <c:if test="#{currentDocument.lockInfo.owner == currentUser and currentDocument.cmbp.needToBeRefreshed == true}">
      <ui:include src="/incl/cm_batch_process_last_process_info.xhtml">
        <ui:param name="lastBatchProcess" value="#{currentDocument.cmbp.itemsLastBatchProcess}" />
        <ui:param name="lastBatchProcessExecutor" value="#{currentDocument.cmbp.itemsLastBatchProcessExecutor}" />
        <ui:param name="lastBatchProcessResultMsg" value="#{currentDocument.cmbp.itemsLastBatchProcessResultMsg}" />
        <ui:param name="lastBatchProcessSuccessResultList" value="#{currentDocument.cmbp.itemsLastBatchProcessSuccessResultList}" />
        <ui:param name="lastBatchProcessErrorResultList" value="#{currentDocument.cmbp.itemsLastBatchProcessErrorResultList}" />
        <ui:param name="lastBatchProcessStarted" value="#{currentDocument.cmbp.itemsLastBatchProcessStarted}" />
        <ui:param name="lastBatchProcessFinished" value="#{currentDocument.cmbp.itemsLastBatchProcessFinished}" />
      </ui:include>
    </c:if>

    <c:if test="#{(currentDocument.lockInfo.owner != currentUser and currentDocument.currentLifeCycleState != 'asyncProcessing')
                  or (currentDocument.lockInfo.owner == currentUser and not currentDocument.cmbp.needToBeRefreshed == true)}">
      <ui:include src="document_not_editable_warning.xhtml"/>

      <ui:include src="/incl/cm_batch_process_last_process_info.xhtml">
        <ui:param name="lastBatchProcess" value="#{currentDocument.cmbp.itemsLastBatchProcess}" />
        <ui:param name="lastBatchProcessExecutor" value="#{currentDocument.cmbp.itemsLastBatchProcessExecutor}" />
        <ui:param name="lastBatchProcessResultMsg" value="#{currentDocument.cmbp.itemsLastBatchProcessResultMsg}" />
        <ui:param name="lastBatchProcessSuccessResultList" value="#{currentDocument.cmbp.itemsLastBatchProcessSuccessResultList}" />
        <ui:param name="lastBatchProcessErrorResultList" value="#{currentDocument.cmbp.itemsLastBatchProcessErrorResultList}" />
        <ui:param name="lastBatchProcessStarted" value="#{currentDocument.cmbp.itemsLastBatchProcessStarted}" />
        <ui:param name="lastBatchProcessFinished" value="#{currentDocument.cmbp.itemsLastBatchProcessFinished}" />
      </ui:include> 

      <nxl:widget name="cm_bom_imp_tt" mode="view" value="#{cmBomImpactedItemsTreeBean}" />
    </c:if>


</ui:composition>
