<ui:composition
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:nxl="http://nuxeo.org/nxforms/layout"
  xmlns:a4j="http://richfaces.org/a4j"
  >
  
    <h:panelGroup layout="block" id="#{widget.id}" rendered="#{nxd:hasPermission(currentDocument, 'Write')
        and currentDocument.isLocked()
        and currentDocumentLockDetails['document.locker'] eq currentUser
        and not currentDocument.isVersion()
        and not currentDocument.isProxy()
        and level == '1'}">

        <a4j:commandButton
            actionListener="#{treeBean.markRelationNodeAsRemoved(node, currentDocument)}"
            render="#{treeWidgetId} :eloraMetadataHeading"
            execute="@this" 
            image="/icons/delete_red.png"
            title="#{messages['eloraplm.command.remove']}"
            rendered="#{isSpecial == 'false' and not nodeData.isRemoved}"
            />
        
        <a4j:commandButton
            actionListener="#{treeBean.unmarkRelationNodeAsRemoved(node, currentDocument)}"
            render="#{treeWidgetId} :eloraMetadataHeading"
            execute="@this" 
            image="/icons/action_undo_16.png"
            title="#{messages['eloraplm.command.undoRemove']}"
            rendered="#{isSpecial == 'false' and nodeData.isRemoved}"
            />
        
        <a4j:commandButton
            image="/icons/delete.png"
            title="#{messages['eloraplm.message.info.relation.mustRemoveFromSubject']}"
            style="cursor: not-allowed"
            rendered="#{isSpecial == 'true'}"
            />
        
    </h:panelGroup>
    
</ui:composition>