<ui:composition
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:a4j="http://richfaces.org/a4j"
    xmlns:nxl="http://nuxeo.org/nxforms/layout"
    xmlns:nxu="http://nuxeo.org/nxweb/util">
    
    <h3>
        <h:outputText value="#{messages['eloraplm.title.relation.add']}" />
    </h3>
    
    <h:form id="#{fancyboxFormId}">
        <h:panelGroup styleClass="content" layout="block">
            <h:panelGrid columns="2" styleClass="dataInput"
                columnClasses="relationCreateLabelColumn, relationCreateFieldColumn">
                <c:if test="#{not isEditablePredicate}">
                  <h:inputHidden id="predicateUri" value="#{basicRelationBean.predicateUri}" />
                  <h:message for="predicateUri" class="errorMessage" />
                </c:if>
                <c:if test="#{isEditablePredicate}">
                  <h:outputLabel for="predicateUri"
                      value="#{messages['label.relation.predicate']}"
                      class="required relationPredicateLabel" />
                  <h:panelGroup>
                      <h:selectOneListbox value="#{basicRelationBean.predicateUri}"
                          id="predicateUri" required="true">
                          <nxu:selectItems value="#{basicRelationBean.getPredicateList()}" var="predicate"
                              itemValue="#{predicate.key}" itemLabel="#{messages[predicate.value]}" />
                      </h:selectOneListbox>
                    
                      <h:message for="predicateUri" class="errorMessage" />
                  </h:panelGroup>
                </c:if>
                
                <h:outputLabel for="objectDocumentUid"
                    value="#{messages['label.relation.object']}"
                    class="required relationObjectLabel" />
                <h:panelGroup>
                    <a4j:outputPanel>
                        <h:inputHidden id="objectDocumentUid"
                            value="#{basicRelationBean.objectDocumentUid}" required="true" />
                        <nxl:widgetType
                            name="eloraSingleDocumentSuggestion"
                            mode="edit" ajaxReRender="objectDocumentUid"
                            value="#{basicRelationBean}"
                            field="objectDocumentUid" translated="true"
                            width="100%"
                            placeholder="label.relation.search.popup.title"
                            pageProviderName="#{pageProviderName}">
                        </nxl:widgetType>
                    </a4j:outputPanel>
                    <h:inputHidden id="objectCheck"
                        validator="#{eloraRelationCreationBean.validateObject}"
                        value="needed">
                        <f:attribute name="objectDocumentUidInputId"
                            value="objectDocumentUid" />
                    </h:inputHidden>
                    <h:message for="objectCheck" class="errorMessage" />
                </h:panelGroup>
                
                <c:if test="#{not isEditableQuantity}">
                  <h:inputHidden id="quantity" value="#{basicRelationBean.quantity}" />
                  <h:message for="quantity" class="errorMessage" />
                </c:if>
                
                <c:if test="#{isEditableQuantity}">
	                <h:outputLabel for="quantity"
	                    value="#{messages['label.relation.quantity']}"
	                    class="required relationQuantityLabel" />
	                <h:panelGroup>
                    <h:inputText class="dataInputText" id="quantity"
                        value="#{basicRelationBean.quantity}" required="true" />
                    <h:message for="quantity" class="errorMessage" />
	                </h:panelGroup>
                </c:if>
                
                <c:if test="#{not isEditableOrdering}">
                  <h:inputHidden id="ordering" value="#{basicRelationBean.ordering}" />
                  <h:message for="ordering" class="errorMessage" />
                </c:if>
                
                <c:if test="#{isEditableOrdering}">
                  <h:outputLabel for="ordering"
                    value="#{messages['eloraplm.label.ordering']}"
                    class="required relationOrderingLabel" />
                  <h:panelGroup>
                    <h:inputText class="dataInputText" id="ordering"
                        value="#{basicRelationBean.ordering}" required="true" />
                    <h:message for="ordering" class="errorMessage" />
                  </h:panelGroup>
                </c:if>
                
                <c:if test="#{not isEditableDirectorOrdering}">
                  <h:inputHidden id="directorOrdering" value="#{basicRelationBean.directorOrdering}" />
                  <h:message for="directorOrdering" class="errorMessage" />
                </c:if>
                
                <h:outputLabel for="ordering"
                    value="#{messages['eloraplm.label.bom.add.direct.relation']}"
                    class="relationOrderingLabel" />
                <h:selectBooleanCheckbox value="#{basicRelationBean.addDirectRelation}" />
                
                <c:if test="#{isEditableDirectorOrdering}">
                  <h:outputLabel for="directorOrdering"
                    value="#{messages['eloraplm.label.bom.director.ordering']}"
                    class="orderingLabel" />
                  <h:panelGroup>
                    <h:inputText class="dataInputText" id="directorOrdering"
                        value="#{basicRelationBean.directorOrdering}" required="false" />
                    <h:message for="directorOrdering" class="errorMessage" />
                  </h:panelGroup>
                </c:if>
                
                <h:outputLabel for="comment"
                    value="#{messages['label.relation.comment']}"
                    class="relationCommentLabel" />
                <h:panelGroup>
                    <h:inputTextarea class="dataInputText" id="comment"
                        value="#{basicRelationBean.comment}"
                        rows="3" cols="60" />
                    <h:message for="comment" class="errorMessage" />
                </h:panelGroup>
            </h:panelGrid>
        </h:panelGroup>
        
        <div class="buttonsGadget">
            <c:if test="#{empty predicate}">
                <h:commandButton value="#{messages['command.add']}"
                    styleClass="button"
                    action="#{basicRelationBean.addRelation()}">
                </h:commandButton>
            </c:if>
            <c:if test="#{not empty predicate}">
                <h:commandButton value="#{messages['command.add']}"
                    styleClass="button"
                    action="#{basicRelationBean.addRelation(predicate)}">
                </h:commandButton>
            </c:if>
            <h:commandButton value="#{messages['command.cancel']}"
                styleClass="button">
                <f:ajax execute="@this" onevent="jQuery.fancybox.close" />
            </h:commandButton>
            
        </div>
        
    </h:form>
</ui:composition>
